fn main() {
    // Build tink-cc from source, along with wrapping code and all deps.
    let tink_wrapped = cmake::Config::new("tink-cc-wrapped")
        .define("CMAKE_POLICY_VERSION_MINIMUM", "3.5")
        .build();

    // Rerun if any wrapped src files have changed.
    println!("cargo:rerun-if-changed=tink-cc-wrapped/CMakeLists.txt");
    println!("cargo:rerun-if-changed=tink-cc-wrapped/src/");

    for dir in TINK_LIB_SEARCH_PATH {
        println!(
            "cargo:rustc-link-search=native={}{}",
            tink_wrapped.display(),
            dir
        );
    }

    // Note, that the order of libraries here matters. Linking fails if they
    // are not in the right order.
    println!("cargo:rustc-link-lib=static=tink_cc_wrapped");
    println!("cargo:rustc-link-lib=stdc++");
    // Link the dependencies.
    // See tink-cc-wrapped/README.md for details about how this is generated.
    for lib in TINK_ORDERED_LB_LIBS_LIST {
        println!("cargo:rustc-link-lib=static={}", lib);
    }
}

// Everywhere to look for libraries.
const TINK_LIB_SEARCH_PATH: &[&str] = &[
    // Include the statically linked Tink files + deps.
    "/build",
    // This was generated using `find _deps -type d`.
    "/build/_deps/abseil-build/absl/base",
    "/build/_deps/abseil-build/absl/container",
    "/build/_deps/abseil-build/absl/crc",
    "/build/_deps/abseil-build/absl/debugging",
    "/build/_deps/abseil-build/absl/flags",
    "/build/_deps/abseil-build/absl/hash",
    "/build/_deps/abseil-build/absl/log",
    "/build/_deps/abseil-build/absl/numeric",
    "/build/_deps/abseil-build/absl/profiling",
    "/build/_deps/abseil-build/absl/random",
    "/build/_deps/abseil-build/absl/status",
    "/build/_deps/abseil-build/absl/strings",
    "/build/_deps/abseil-build/absl/synchronization",
    "/build/_deps/abseil-build/absl/time",
    "/build/_deps/abseil-build/absl/types",
    "/build/_deps/boringssl-build",
    "/build/_deps/boringssl-build/crypto",
    "/build/_deps/com_google_protobuf-build/third_party/utf8_range",
    "/build/_deps/com_google_protobuf-build",
    "/build/_deps/tink-build/proto",
    "/build/_deps/tink-build/tink",
    "/build/_deps/tink-build/tink/aead",
    "/build/_deps/tink-build/tink/aead/internal",
    "/build/_deps/tink-build/tink/config",
    "/build/_deps/tink-build/tink/daead",
    "/build/_deps/tink-build/tink/daead/subtle",
    "/build/_deps/tink-build/tink/hybrid",
    "/build/_deps/tink-build/tink/hybrid/internal",
    "/build/_deps/tink-build/tink/internal",
    "/build/_deps/tink-build/tink/json",
    "/build/_deps/tink-build/tink/mac",
    "/build/_deps/tink-build/tink/mac/internal",
    "/build/_deps/tink-build/tink/prf",
    "/build/_deps/tink-build/tink/prf/internal",
    "/build/_deps/tink-build/tink/signature",
    "/build/_deps/tink-build/tink/signature/internal",
    "/build/_deps/tink-build/tink/streamingaead",
    "/build/_deps/tink-build/tink/subtle",
    "/build/_deps/tink-build/tink/subtle/prf",
    "/build/_deps/tink-build/tink/util",
];

// The precise ordered set of libraries to pass to the linker.
// If this is in the wrong order, linking will fail.
// See tink-cc-wrapped/README.md for details about how this is generated.
const TINK_ORDERED_LB_LIBS_LIST: &[&str] = &[
    "absl_flags_parse",
    "tink_internal_core_binary_keyset_reader",
    "tink_internal_core_binary_keyset_writer",
    "tink_internal_core_cleartext_keyset_handle",
    "tink_internal_json_json_keyset_reader",
    "tink_internal_json_json_keyset_writer",
    "tink_core_keyset_manager",
    "tink_internal_core_version",
    "tink_internal_aead_aead_factory",
    "tink_internal_config_tink_config",
    "tink_internal_prf_prf_config",
    "tink_internal_prf__internal_aes_cmac_prf_proto_serialization_impl",
    "tink_internal_proto_aes_cmac_prf_cc_proto",
    "tink_internal_prf_aes_cmac_prf_key",
    "tink_internal_prf_aes_cmac_prf_parameters",
    "tink_internal_subtle__prf_hkdf_streaming_prf",
    "tink_internal_prf__internal_hkdf_prf_proto_serialization_impl",
    "tink_internal_proto_hkdf_prf_cc_proto",
    "tink_internal_prf_hkdf_prf_key",
    "tink_internal_prf_hkdf_prf_parameters",
    "tink_internal_prf_hmac_prf_key_manager",
    "tink_internal_subtle__prf_prf_set_util",
    "tink_internal_prf__internal_hmac_prf_proto_serialization_impl",
    "tink_internal_proto_hmac_prf_cc_proto",
    "tink_internal_prf_hmac_prf_key",
    "tink_internal_prf_hmac_prf_parameters",
    "tink_internal_prf_prf_set_wrapper",
    "tink_internal_prf_prf_set",
    "tink_internal_daead_deterministic_aead_config",
    "tink_internal_daead_aes_siv_proto_serialization",
    "tink_internal_daead_aes_siv_key",
    "tink_internal_daead_deterministic_aead_factory",
    "tink_internal_daead_deterministic_aead_wrapper",
    "tink_internal_hybrid_hybrid_config",
    "tink_internal_aead_aead_config",
    "tink_internal_aead_aead_wrapper",
    "tink_internal_aead_aes_ctr_hmac_aead_proto_serialization",
    "tink_internal_aead_aes_ctr_hmac_aead_key",
    "tink_internal_subtle_aes_eax_boringssl",
    "tink_internal_aead_aes_eax_proto_serialization",
    "tink_internal_aead_aes_eax_key",
    "tink_internal_aead_aes_eax_parameters",
    "tink_internal_aead__internal_aes_gcm_proto_serialization_impl",
    "tink_internal_aead_aes_gcm_key",
    "tink_internal_subtle_aes_gcm_siv_boringssl",
    "tink_internal_aead_aes_gcm_siv_proto_serialization",
    "tink_internal_aead_aes_gcm_siv_key",
    "tink_internal_aead_aes_gcm_siv_parameters",
    "tink_internal_aead__internal_chacha20_poly1305_proto_serialization_impl",
    "tink_internal_aead_chacha20_poly1305_key",
    "tink_internal_aead_chacha20_poly1305_parameters",
    "tink_internal_proto_chacha20_poly1305_cc_proto",
    "tink_internal_proto_kms_aead_cc_proto",
    "tink_internal_aead_kms_envelope_aead_key_manager",
    "tink_internal_core_kms_clients",
    "tink_internal_aead_kms_envelope_aead",
    "tink_internal_aead_x_aes_gcm_key_manager",
    "tink_internal_aead__internal_cord_x_aes_gcm_boringssl",
    "tink_internal_aead__internal_cord_aes_gcm_boringssl",
    "tink_internal_aead__internal_cord_utils",
    "tink_internal_aead__internal_zero_copy_x_aes_gcm_boringssl",
    "tink_internal_aead__internal_base_x_aes_gcm",
    "tink_internal_aead__internal_x_aes_gcm_proto_serialization_impl",
    "tink_internal_aead_x_aes_gcm_key",
    "tink_internal_aead_x_aes_gcm_parameters",
    "tink_internal_aead__internal_xchacha20_poly1305_proto_serialization_impl",
    "tink_internal_aead_xchacha20_poly1305_key",
    "tink_internal_hybrid_ecies_aead_hkdf_private_key_manager",
    "tink_internal_hybrid_ecies_aead_hkdf_hybrid_decrypt",
    "tink_internal_subtle_ecies_hkdf_recipient_kem_boringssl",
    "tink_internal_hybrid_ecies_aead_hkdf_public_key_manager",
    "tink_internal_hybrid_ecies_aead_hkdf_hybrid_encrypt",
    "tink_internal_hybrid__internal_ecies_aead_hkdf_dem_helper",
    "tink_internal_aead_aes_ctr_hmac_aead_key_manager",
    "tink_internal_subtle_aes_ctr_boringssl",
    "tink_internal_subtle_encrypt_then_authenticate",
    "tink_internal_subtle_aes_gcm_boringssl",
    "tink_internal_aead__internal_aead_from_zero_copy",
    "tink_internal_aead__internal_zero_copy_aes_gcm_boringssl",
    "tink_internal_subtle_xchacha20_poly1305_boringssl",
    "tink_internal_subtle_aes_siv_boringssl",
    "tink_internal_daead__subtle_aead_or_daead",
    "tink_internal_subtle_ecies_hkdf_sender_kem_boringssl",
    "tink_internal_hybrid_ecies_proto_serialization",
    "tink_internal_proto_xchacha20_poly1305_cc_proto",
    "tink_internal_hybrid_ecies_private_key",
    "tink_internal_hybrid_ecies_public_key",
    "tink_internal_hybrid_ecies_parameters",
    "tink_internal_aead_aes_ctr_hmac_aead_parameters",
    "tink_internal_daead_aes_siv_parameters",
    "tink_internal_aead_aes_gcm_parameters",
    "tink_internal_aead_xchacha20_poly1305_parameters",
    "tink_internal_hybrid_hybrid_decrypt_factory",
    "tink_internal_hybrid_hybrid_decrypt_wrapper",
    "tink_internal_hybrid_hybrid_encrypt_factory",
    "tink_internal_hybrid_hybrid_encrypt_wrapper",
    "tink_internal_hybrid_hybrid_key_templates",
    "tink_internal_aead_aead_key_templates",
    "tink_internal_proto_aes_ctr_hmac_aead_cc_proto",
    "tink_internal_proto_aes_ctr_cc_proto",
    "tink_internal_proto_aes_eax_cc_proto",
    "tink_internal_proto_aes_gcm_cc_proto",
    "tink_internal_proto_aes_gcm_siv_cc_proto",
    "tink_internal_proto_kms_envelope_cc_proto",
    "tink_internal_proto_x_aes_gcm_cc_proto",
    "tink_internal_daead_deterministic_aead_key_templates",
    "tink_internal_proto_aes_siv_cc_proto",
    "tink_internal_proto_ecies_aead_hkdf_cc_proto",
    "tink_internal_proto_hpke_cc_proto",
    "tink_internal_mac_mac_config",
    "tink_internal_subtle_aes_cmac_boringssl",
    "tink_internal_mac_aes_cmac_proto_serialization",
    "tink_internal_mac_aes_cmac_key",
    "tink_internal_mac_aes_cmac_parameters",
    "tink_internal_mac_hmac_key_manager",
    "tink_internal_mac__internal_chunked_mac_impl",
    "tink_internal_mac__internal_stateful_cmac_boringssl",
    "tink_internal_mac__internal_stateful_hmac_boringssl",
    "tink_internal_mac_hmac_proto_serialization",
    "tink_internal_mac_hmac_key",
    "tink_internal_mac_hmac_parameters",
    "tink_internal_mac__internal_chunked_mac_wrapper",
    "tink_internal_mac_mac_factory",
    "tink_internal_mac_mac_wrapper",
    "tink_internal_mac_mac_key_templates",
    "tink_internal_proto_aes_cmac_cc_proto",
    "tink_internal_signature_public_key_sign_factory",
    "tink_internal_signature_public_key_verify_factory",
    "tink_internal_core_keyset_handle",
    "tink_internal_internal_keyset_handle_builder_entry",
    "tink_internal_config_global_registry",
    "tink_internal_util_keyset_util",
    "tink_internal_signature_signature_config",
    "tink_internal_signature_public_key_sign_wrapper",
    "tink_internal_signature_public_key_verify_wrapper",
    "tink_internal_signature_ecdsa_proto_serialization",
    "tink_internal_internal_bn_encoding_util",
    "tink_internal_signature_ed25519_proto_serialization",
    "tink_internal_signature_ed25519_sign_key_manager",
    "tink_internal_subtle_ed25519_sign_boringssl",
    "tink_internal_signature_ed25519_private_key",
    "tink_internal_signature_ed25519_verify_key_manager",
    "tink_internal_subtle_ed25519_verify_boringssl",
    "tink_internal_signature_ed25519_public_key",
    "tink_internal_signature_ed25519_parameters",
    "tink_internal_signature_rsa_ssa_pkcs1_proto_serialization",
    "tink_internal_signature_rsa_ssa_pkcs1_sign_key_manager",
    "tink_internal_subtle_rsa_ssa_pkcs1_sign_boringssl",
    "tink_internal_signature_rsa_ssa_pkcs1_private_key",
    "tink_internal_signature_rsa_ssa_pkcs1_verify_key_manager",
    "tink_internal_subtle_rsa_ssa_pkcs1_verify_boringssl",
    "tink_internal_signature_rsa_ssa_pkcs1_public_key",
    "tink_internal_signature_rsa_ssa_pkcs1_parameters",
    "tink_internal_signature_rsa_ssa_pss_proto_serialization",
    "tink_internal_internal_proto_parser_fields",
    "tink_internal_internal_proto_parsing_helpers",
    "tink_internal_internal_proto_parser_state",
    "tink_internal_internal_secret_data_with_crc",
    "tink_internal_signature_rsa_ssa_pss_sign_key_manager",
    "tink_internal_signature_sig_util",
    "tink_internal_subtle_rsa_ssa_pss_sign_boringssl",
    "tink_internal_signature_rsa_ssa_pss_private_key",
    "tink_internal_signature_rsa_ssa_pss_verify_key_manager",
    "tink_internal_subtle_rsa_ssa_pss_verify_boringssl",
    "tink_internal_signature_rsa_ssa_pss_public_key",
    "tink_internal_signature_rsa_ssa_pss_parameters",
    "tink_internal_signature_ecdsa_sign_key_manager",
    "tink_internal_signature_ecdsa_verify_key_manager",
    "tink_internal_subtle_ecdsa_verify_boringssl",
    "tink_internal_subtle_ecdsa_sign_boringssl",
    "tink_internal_signature_ecdsa_private_key",
    "tink_internal_core_restricted_big_integer",
    "tink_internal_signature_ecdsa_public_key",
    "tink_internal_core_big_integer",
    "tink_internal_signature_ecdsa_parameters",
    "tink_internal_signature__internal_ecdsa_raw_sign_boringssl",
    "tink_internal_internal_ec_util",
    "tink_internal_internal_rsa_util",
    "tink_internal_signature_signature_key_templates",
    "tink_internal_internal_bn_util",
    "tink_internal_proto_ed25519_cc_proto",
    "tink_internal_proto_rsa_ssa_pkcs1_cc_proto",
    "tink_internal_proto_rsa_ssa_pss_cc_proto",
    "tink_internal_streamingaead_streaming_aead_config",
    "tink_internal_config_tink_fips",
    "tink_internal_internal_registry_impl",
    "tink_internal_internal_key_type_info_store",
    "tink_internal_internal_key_info",
    "tink_internal_internal_internal_insecure_secret_key_access",
    "tink_internal_internal_key_status_util",
    "tink_internal_config_config_util",
    "tink_internal_streamingaead_aes_ctr_hmac_streaming_key_manager",
    "tink_internal_subtle_aes_ctr_hmac_streaming",
    "tink_internal_subtle_hmac_boringssl",
    "tink_internal_internal_aes_util",
    "tink_internal_streamingaead_aes_ctr_hmac_streaming_proto_serialization",
    "tink_internal_streamingaead_aes_ctr_hmac_streaming_key",
    "tink_internal_streamingaead_aes_ctr_hmac_streaming_parameters",
    "tink_internal_streamingaead_aes_gcm_hkdf_streaming_key_manager",
    "tink_internal_core_key_manager",
    "tink_internal_util_enums",
    "tink_internal_proto_ecdsa_cc_proto",
    "tink_internal_util_constants",
    "tink_internal_util_input_stream_util",
    "tink_internal_subtle_aes_gcm_hkdf_streaming",
    "tink_internal_internal_fips_utils",
    "tink_internal_subtle_nonce_based_streaming_aead",
    "tink_internal_subtle_decrypting_random_access_stream",
    "tink_internal_subtle_streaming_aead_decrypting_stream",
    "tink_internal_subtle_streaming_aead_encrypting_stream",
    "tink_internal_subtle_aes_gcm_hkdf_stream_segment_decrypter",
    "tink_internal_subtle_aes_gcm_hkdf_stream_segment_encrypter",
    "tink_internal_aead__internal_ssl_aead",
    "tink_internal_aead__internal_aead_util",
    "tink_internal_subtle_hkdf",
    "tink_internal_internal_md_util",
    "tink_internal_subtle_common_enums",
    "tink_internal_internal_err_util",
    "tink_internal_streamingaead_aes_gcm_hkdf_streaming_proto_serialization",
    "tink_internal_internal_mutable_serialization_registry",
    "tink_internal_internal_serialization_registry",
    "tink_internal_internal_legacy_proto_key",
    "tink_internal_internal_legacy_proto_parameters",
    "tink_internal_internal_proto_key_serialization",
    "tink_internal_internal_proto_parameters_serialization",
    "tink_internal_internal_util",
    "tink_internal_streamingaead_aes_gcm_hkdf_streaming_key",
    "tink_internal_core_restricted_data",
    "tink_internal_subtle_random",
    "tink_internal_subtle_subtle_util",
    "tink_internal_streamingaead_aes_gcm_hkdf_streaming_parameters",
    "tink_internal_streamingaead_streaming_aead_wrapper",
    "tink_internal_streamingaead_decrypting_input_stream",
    "tink_internal_streamingaead_buffered_input_stream",
    "tink_internal_streamingaead_decrypting_random_access_stream",
    "tink_internal_core_crypto_format",
    "tink_internal_streamingaead_streaming_aead_key_templates",
    "tink_internal_proto_aes_ctr_hmac_streaming_cc_proto",
    "tink_internal_proto_hmac_cc_proto",
    "tink_internal_proto_aes_gcm_hkdf_streaming_cc_proto",
    "tink_internal_util_buffer",
    "protobuf-lited",
    "crypto",
    "tink_internal_util_validation",
    "tink_internal_proto_config_cc_proto",
    "tink_internal_proto_tink_cc_proto",
    "tink_internal_proto_common_cc_proto",
    "utf8_validity",
    "protocd",
    "protobufd",
    "utf8_validity",
    "absl_statusor",
    "absl_status",
    "absl_log_internal_check_op",
    "absl_leak_check",
    "absl_die_if_null",
    "absl_log_internal_conditions",
    "absl_log_internal_message",
    "absl_strerror",
    "absl_log_internal_nullguard",
    "absl_examine_stack",
    "absl_log_internal_format",
    "absl_log_internal_proto",
    "absl_log_internal_log_sink_set",
    "absl_log_sink",
    "absl_log_entry",
    "absl_log_initialize",
    "absl_log_internal_globals",
    "absl_log_globals",
    "absl_vlog_config_internal",
    "absl_log_internal_fnmatch",
    "absl_random_distributions",
    "absl_random_seed_sequences",
    "absl_random_internal_pool_urbg",
    "absl_random_internal_randen",
    "absl_random_internal_randen_hwaes",
    "absl_random_internal_randen_hwaes_impl",
    "absl_random_internal_randen_slow",
    "absl_random_internal_platform",
    "absl_random_internal_seed_material",
    "absl_random_seed_gen_exception",
    "absl_flags_usage",
    "absl_flags_usage_internal",
    "absl_flags_internal",
    "absl_flags_marshalling",
    "absl_flags_reflection",
    "absl_cord",
    "absl_cordz_info",
    "absl_cord_internal",
    "absl_cordz_functions",
    "absl_cordz_handle",
    "absl_crc_cord_state",
    "absl_crc32c",
    "absl_str_format_internal",
    "absl_crc_internal",
    "absl_crc_cpu_detect",
    "absl_raw_hash_set",
    "absl_hash",
    "absl_bad_variant_access",
    "absl_city",
    "absl_low_level_hash",
    "absl_hashtablez_sampler",
    "absl_exponential_biased",
    "absl_flags_config",
    "absl_flags_program_name",
    "absl_synchronization",
    "absl_stacktrace",
    "absl_symbolize",
    "absl_debugging_internal",
    "absl_demangle_internal",
    "absl_demangle_rust",
    "absl_decode_rust_punycode",
    "absl_utf8_for_code_point",
    "absl_graphcycles_internal",
    "absl_kernel_timeout_internal",
    "absl_malloc_internal",
    "absl_time",
    "absl_civil_time",
    "absl_time_zone",
    "absl_flags_private_handle_accessor",
    "absl_flags_commandlineflag",
    "absl_bad_optional_access",
    "absl_flags_commandlineflag_internal",
    "absl_strings",
    "absl_strings_internal",
    "absl_string_view",
    "absl_base",
    "absl_spinlock_wait",
    "absl_int128",
    "absl_throw_delegate",
    "absl_raw_logging_internal",
    "absl_log_severity",
];
